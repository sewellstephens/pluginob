<script>
  
  top.postMessage("loaded success", "*");

window.addEventListener("message", event => {

  
if (event.data.siteid === 'ob-ftgyhuijihuygtfrfgyh') {

  fetch('https://api.ipdata.co?api-key=e86a2f1832209ffe37f95432a1f1e82086fe500348fca5e93728a852', {
          method: 'GET', // or 'PUT'
          headers: {
            'Accept': 'application/json',
          }
        })
          .then((response) => response.json())
          .then((jsonattr) => {

            let siteid = event.data.siteid;
let email = event.data.email;
let realmessage = event.data.realmessage;
let message = event.data.message;
let url = event.data.url;
let type = event.data.type;
let key = event.data.key;
let screenofpage = event.data.screenofpage;
let starrating = event.data.starrating;
let daat1 = `Email: ${event.data.email}
	Page: ${event.data.url}
	Type: ${event.data.type}
  Rating: ${event.data.starrating}
	Message: ${event.data.realmessage}`;

            let subdata = {
      "email": email,
      "realmessage": realmessage,
      "message": daat1,
      "url": url,
      "type": type,
      "key": key,
      "screenshot": screenofpage,
      "starrating": starrating,
      "siteid": siteid,
      "ipaddress": jsonattr.ip,
      "country": jsonattr.country_name,
      "flag": jsonattr.flag
    }

fetch('https://events.hookdeck.com/e/src_UUj0G2kTCMfR', {
          method: 'POST', // or 'PUT'
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(subdata),
        })
          .then((response) => response.json())
          .then((subdata) => {
            console.log('Success:');
          })
          .catch((error) => {
            console.error('Error:', error);
          });
          })
          .catch((error) => {
            console.error('Error:', error);
          });
}
else {

}
});
</script>